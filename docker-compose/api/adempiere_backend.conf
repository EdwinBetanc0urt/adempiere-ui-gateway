# ADempiere Envoy service transcoding from gRPC to JSON
#
location /v1/ {
    # Policy configuration here (authentication, rate limiting, logging...)
    #

    access_log /var/log/nginx/adempiere_backend.log main;

    location /v1/open-id/services/ {
        # The problem is conecting with envoy proxy
        # See: https://www.digitalocean.com/community/questions/how-to-solve-nginx-websocket-secure-wss-error-426-upgrade-required
        proxy_http_version 1.1;
        proxy_pass http://adempiere_backend/security/services;
    }

    return 404; # Catch-all
}